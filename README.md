# Amigo

ä¸€ä¸ªåŸºäº WebSocket çš„ AI æ™ºèƒ½ä½“ç³»ç»Ÿï¼Œæ”¯æŒå¯¹è¯å¼å·¥ä½œæµç®¡ç†å’Œä»»åŠ¡å§”æ´¾åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ”„ **å®æ—¶é€šä¿¡** - é€šè¿‡ WebSocket å®ç°å‰åç«¯åŒå‘å®æ—¶é€šä¿¡
- ğŸ“‹ **å±‚çº§ä»»åŠ¡ç®¡ç†** - æ”¯æŒçˆ¶å­ä»»åŠ¡å…³ç³»çš„å±‚çº§åŒ–ä»»åŠ¡ç®¡ç†
- ğŸ¤– **LLM é©±åŠ¨** - åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„å¯¹è¯ç®¡ç†å’Œæµå¼å“åº”
- ğŸ”§ **å·¥å…·æ‰©å±•** - å¯æ‰©å±•çš„å·¥å…·ç³»ç»Ÿï¼Œæ”¯æŒè‡ªå®šä¹‰æ™ºèƒ½ä½“è¡Œä¸º
- ğŸ’¾ **æŒä¹…åŒ–å­˜å‚¨** - å¯¹è¯å†å²å’ŒçŠ¶æ€çš„æŒä¹…åŒ–ç®¡ç†
- ğŸš€ **å­æ™ºèƒ½ä½“** - æ”¯æŒç”Ÿæˆå­æ™ºèƒ½ä½“è¿›è¡Œå¹¶è¡Œä»»åŠ¡æ‰§è¡Œ

## æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: React 18 + TypeScript
- **æ„å»ºå·¥å…·**: Vite 6
- **æ ·å¼**: Tailwind CSS 4 + DaisyUI
- **çŠ¶æ€ç®¡ç†**: Zustand + React Context
- **å›¾æ ‡**: Lucide React, React Icons

### åç«¯
- **è¿è¡Œæ—¶**: Bun
- **WebSocket**: åŸç”Ÿ Bun WebSocket æ”¯æŒ
- **LLM æ¡†æ¶**: LangChain (@langchain/core, @langchain/langgraph)
- **æ•°æ®éªŒè¯**: Zod
- **XML è§£æ**: fast-xml-parser

### å¼€å‘å·¥å…·
- **åŒ…ç®¡ç†å™¨**: pnpm (workspace)
- **ä»£ç è´¨é‡**: Biome (æ›¿ä»£ ESLint + Prettier)
- **ç±»å‹æ£€æŸ¥**: TypeScript (ä¸¥æ ¼æ¨¡å¼)

## é¡¹ç›®ç»“æ„

```
packages/
â”œâ”€â”€ frontend/          # React å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/      # UI ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ messages/        # æ¶ˆæ¯å¤„ç†é€»è¾‘
â”‚   â”‚   â””â”€â”€ store/           # çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ server/            # Bun åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ core/            # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”‚   â”‚   â”œâ”€â”€ conversationManager/  # å¯¹è¯ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ memory/               # æŒä¹…åŒ–å­˜å‚¨
â”‚   â”‚   â”‚   â”œâ”€â”€ tools/                # æ™ºèƒ½ä½“å·¥å…·
â”‚   â”‚   â”‚   â””â”€â”€ systemPrompt/         # ç³»ç»Ÿæç¤ºè¯
â”‚   â”‚   â””â”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ package.json
â””â”€â”€ types/             # å…±äº«ç±»å‹å®šä¹‰
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ conversation/    # å¯¹è¯ç±»å‹
    â”‚   â”œâ”€â”€ tool/            # å·¥å…·å‚æ•°ç±»å‹
    â”‚   â””â”€â”€ websocketMessage/ # WebSocket æ¶ˆæ¯æ¨¡å¼
    â””â”€â”€ package.json
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18+
- pnpm 10+
- Bun (ç”¨äºåç«¯è¿è¡Œ)

### å®‰è£…ä¾èµ–

```bash
pnpm install
```

### é…ç½®ç¯å¢ƒå˜é‡

åœ¨ `packages/server/` ç›®å½•ä¸‹åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# æ·»åŠ ä½ çš„ç¯å¢ƒå˜é‡é…ç½®
# ä¾‹å¦‚: API keys, æ•°æ®åº“è¿æ¥ç­‰
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# åŒæ—¶å¯åŠ¨å‰ç«¯å’Œåç«¯
pnpm dev

# æˆ–è€…åˆ†åˆ«å¯åŠ¨

# ä»…å¯åŠ¨å‰ç«¯ (é»˜è®¤ç«¯å£: 5173)
cd packages/frontend && pnpm start

# ä»…å¯åŠ¨åç«¯ (é»˜è®¤ç«¯å£: 10013)
cd packages/server && pnpm start
```

### æ„å»ºé¡¹ç›®

```bash
# æ„å»ºå‰ç«¯
cd packages/frontend && pnpm build

# æ„å»ºç±»å‹åŒ…
cd packages/types && pnpm build
```

## æ ¸å¿ƒæ¶æ„

### æ¶ˆæ¯æµç¨‹

1. ç”¨æˆ·é€šè¿‡ WebSocket å‘é€æ¶ˆæ¯
2. æœåŠ¡å™¨è§£ææ¶ˆæ¯ç±»å‹å¹¶åˆ›å»º/æ£€ç´¢ ConversationManager
3. ConversationManager æµå¼å¤„ç† LLM å“åº”
4. XML è§£æå™¨ä»æµä¸­æå–å·¥å…·è°ƒç”¨
5. å·¥å…·æ‰§è¡Œå¹¶å°†ç»“æœå‘é€å›å®¢æˆ·ç«¯
6. æ‰€æœ‰æ¶ˆæ¯æŒä¹…åŒ–åˆ°å­˜å‚¨

### å·¥å…·ç³»ç»Ÿ

- å·¥å…·å®šä¹‰åœ¨ `packages/server/src/core/tools/`
- å·¥å…·æ¨¡å¼åœ¨ `packages/types/src/tool/`
- å·¥å…·å¯ä»¥ç”Ÿæˆå¸¦æœ‰è‡ªå®šä¹‰æç¤ºè¯çš„å­æ™ºèƒ½ä½“
- åŸºäº XML æ ¼å¼çš„å·¥å…·è°ƒç”¨

### çŠ¶æ€ç®¡ç†

- **æœåŠ¡ç«¯**: FilePersistedMemory ç”¨äºå¯¹è¯å†å²
- **å®¢æˆ·ç«¯**: Zustand + React Context ç”¨äº WebSocket çŠ¶æ€
- **ä»»åŠ¡å±‚çº§**: é€šè¿‡çˆ¶å­å…³ç³»è¿½è¸ªä»»åŠ¡å±‚çº§

## å¼€å‘æŒ‡å—

### è·¯å¾„åˆ«å

ä½¿ç”¨ `@/*` å¯¼å…¥ç›¸å¯¹äº `src/` ç›®å½•çš„æ–‡ä»¶ï¼š

```typescript
import { logger } from "@/utils/logger"
```

### ä»£ç è§„èŒƒ

```bash
# ä½¿ç”¨ Biome æ ¼å¼åŒ–å’Œæ£€æŸ¥ä»£ç 
biome check --write .
```

### å‘½åçº¦å®š

- ç»„ä»¶: PascalCase (ä¾‹å¦‚: `ChatWindow.tsx`)
- å·¥å…·å‡½æ•°: camelCase (ä¾‹å¦‚: `parseStreamingXml.ts`)
- ç±»å‹: PascalCase æ¥å£/ç±»å‹
- æ–‡ä»¶: ä¸ä¸»è¦å¯¼å‡ºåç§°åŒ¹é…

## å­˜å‚¨

å¯¹è¯æ•°æ®æŒä¹…åŒ–åœ¨ `packages/server/storage/` ç›®å½•ã€‚

## è®¸å¯è¯

ISC

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼
